{
    "id": "org.flatpak.Builder.BaseApp",
    "branch": "23.08",
    "runtime": "org.freedesktop.Platform",
    "sdk": "org.freedesktop.Sdk",
    "runtime-version": "23.08",
    "separate-locales": false,
    "sdk-extensions": [
        "org.freedesktop.Sdk.Extension.rust-stable",
        "org.freedesktop.Sdk.Extension.llvm16"
    ],
    "build-options": {
        "append-path": "/usr/lib/sdk/rust-stable/bin:/usr/lib/sdk/llvm16/bin",
        "env": {
            "BASH_COMPLETIONSDIR": "/app/share/bash-completion/completions",
            "MOUNT_FUSE_PATH": "../tmp/",
            "V": "1"
        }
    },
    "cleanup": [
        "*.a",
        "*.la",
        "/build-1",
        "/etc",
        "/lib/cmake",
        "/libexec/installed-tests",
        "/libexec/libostree",
        "/man",
        "/share/aclocal",
        "/share/bash-completion",
        "/share/dbus-1",
        "/share/doc",
        "/share/gtk-doc",
        "/share/installed-tests",
        "/share/lua",
        "/share/man",
        "/share/ostree",
        "/share/pkgconfig",
        "/share/thumbnailers",
        "/var"
    ],
    "modules": [
        "xvfb.json",
        "jq.json",
        "gh.json",
        {
            "name": "dbus",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://dbus.freedesktop.org/releases/dbus/dbus-1.14.10.tar.xz",
                    "sha256": "ba1f21d2bd9d339da2d4aa8780c09df32fea87998b73da24f49ab9df1e36a50f",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": 5356,
                        "stable-only": true,
                        "url-template": "https://dbus.freedesktop.org/releases/dbus/dbus-$version.tar.xz"
                    }
                }
            ]
        },
        {
            "name": "libyaml",
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/yaml/libyaml.git",
                    "tag": "0.2.5",
                    "commit": "2c891fc7a770e8ba2fec34fc6b545c672beb37e6",
                    "x-checker-data": {
                        "type": "git",
                        "tag-pattern": "^([\\d.]+)$"
                    }
                }
            ]
        },
        {
            "name": "stemmer",
            "buildsystem": "simple",
            "build-commands": [
                "make libstemmer.so.0 -j$FLATPAK_BUILDER_N_JOBS",
                "install -Dm644 include/libstemmer.h /app/include/libstemmer.h",
                "install -Dm644 libstemmer.so.0 /app/lib/libstemmer.so.0.0.0",
                "ln -s libstemmer.so.0.0.0 /app/lib/libstemmer.so.0",
                "ln -s libstemmer.so.0 /app/lib/libstemmer.so"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/snowballstem/snowball.git",
                    "tag": "v2.2.0",
                    "commit": "48a67a2831005f49c48ec29a5837640e23e54e6b",
                    "x-checker-data": {
                        "type": "git",
                        "tag-pattern": "^v([\\d.]+)$"
                    }
                },
                {
                    "type": "patch",
                    "path": "patches/stemmer-dynlib.patch"
                }
            ]
        },
        {
            "name": "popt",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://ftp.osuosl.org/pub/rpm/popt/releases/popt-1.x/popt-1.19.tar.gz",
                    "sha256": "c25a4838fc8e4c1c8aacb8bd620edb3084a3d63bf8987fdad3ca2758c63240f9",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": 3689,
                        "stable-only": true,
                        "url-template": "https://ftp.osuosl.org/pub/rpm/popt/releases/popt-1.x/popt-$version.tar.gz"
                    }
                }
            ]
        },
        "shared-modules/lua5.4/lua-5.4.json",
        {
            "name": "rpm",
            "buildsystem": "cmake",
            "config-opts": [
                "-DENABLE_TESTSUITE=OFF",
                "-DWITH_AUDIT=OFF",
                "-DENABLE_PYTHON=OFF",
                "-DWITH_INTERNAL_OPENPGP=ON"
            ],
            "cleanup": [
                "/bin/rpm*",
                "/lib/rpm",
                "/lib/librpm.so*",
                "/lib/librpmbuild.so*",
                "/lib/librpmsign.so*"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://ftp.osuosl.org/pub/rpm/releases/rpm-4.19.x/rpm-4.19.1.1.tar.bz2",
                    "sha256": "874091b80efe66f9de8e3242ae2337162e2d7131e3aa4ac99ac22155e9c521e5"
                }
            ]
        },
        {
            "name": "rpm2cpio",
            "buildsystem": "simple",
            "build-commands": [
                "install -Dm755 rpm2cpio /app/bin/rpm2cpio"
            ],
            "sources": [
                {
                    "type": "file",
                    "url": "https://gitlab.archlinux.org/archlinux/packaging/packages/rpmextract/-/raw/9763231c8ae0539c6d7fe8ad31967b2175089743/rpm2cpio",
                    "sha256": "5b9133774a969e9b2c4b18c77b340ed1e591e13ba1336fd4a4c15a96ad436dee"
                }
            ]
        },
        {
            "name": "svn",
            "modules": [
                {
                    "name": "apr",
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://dlcdn.apache.org/apr/apr-1.7.4.tar.bz2",
                            "sha256": "fc648de983f3a2a6c9e78dea1f180639bd2fad6c06d556d4367a701fe5c35577",
                            "x-checker-data": {
                                "type": "anitya",
                                "project-id": 95,
                                "stable-only": true,
                                "url-template": "https://dlcdn.apache.org/apr/apr-$version.tar.bz2"
                            }
                        }
                    ]
                },
                {
                    "name": "apr-util",
                    "config-opts": [
                        "--with-apr=/app"
                    ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://dlcdn.apache.org//apr/apr-util-1.6.3.tar.bz2",
                            "sha256": "a41076e3710746326c3945042994ad9a4fcac0ce0277dd8fea076fec3c9772b5",
                            "x-checker-data": {
                                "type": "anitya",
                                "project-id": 96,
                                "stable-only": true,
                                "url-template": "https://dlcdn.apache.org//apr/apr-util-$version.tar.bz2"
                            }
                        }
                    ]
                },
                {
                    "name": "utf8proc",
                    "buildsystem": "cmake-ninja",
                    "config-opts": [
                        "-DBUILD_SHARED_LIBS=ON",
                        "-DUTF8PROC_INSTALL=ON",
                        "-DUTF8PROC_ENABLE_TESTING=OFF"
                    ],
                    "builddir": true,
                    "sources": [
                        {
                            "type": "git",
                            "url": "https://github.com/JuliaStrings/utf8proc.git",
                            "tag": "v2.9.0",
                            "commit": "34db3f7954e9298e89f42641ac78e0450f80a70d",
                            "x-checker-data": {
                                "type": "git",
                                "tag-pattern": "^v([\\d.]+)$"
                            }
                        }
                    ]
                },
                {
                    "name": "scons",
                    "buildsystem": "simple",
                    "cleanup": ["*"],
                    "build-commands": [
                        "pip3 install --no-index --no-build-isolation --prefix=/app ."
                    ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://downloads.sourceforge.net/project/scons/scons/4.7.0/SCons-4.7.0.tar.gz",
                            "sha256": "d9fcd831700ce373ecd30ac55e9d7eff20754215cff5967c4972237d614a326e"
                        }
                    ]
                },
                {
                    "name": "serf",
                    "buildsystem": "simple",
                    "build-commands": [
                        "scons PREFIX=${FLATPAK_DEST} APR=/app/bin/apr-1-config APU=/app/bin/apu-1-config",
                        "scons install prefix=${FLATPAK_DEST}"
                    ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://downloads.apache.org/serf/serf-1.3.10.tar.bz2",
                            "sha256": "be81ef08baa2516ecda76a77adf7def7bc3227eeb578b9a33b45f7b41dc064e6",
                            "x-checker-data": {
                                "type": "html",
                                "url": "https://downloads.apache.org/serf/",
                                "pattern": "(serf-([\\d.]+).tar.bz2)"
                            }
                        }
                    ]
                },
                {
                    "name": "subversion",
                    "config-opts": [
                        "--with-lz4=internal",
                        "--with-serf"
                    ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://downloads.apache.org/subversion/subversion-1.14.3.tar.bz2",
                            "sha256": "949efd451a09435f7e8573574c71c7b71b194d844890fa49cd61d2262ea1a440",
                            "x-checker-data": {
                                "type": "html",
                                "url": "https://downloads.apache.org/subversion/",
                                "pattern": "(subversion-([\\d.]+).tar.bz2)"
                            }
                        }
                    ],
                    "post-install": [
                        "cp -v /app/share/pkgconfig/*.pc /app/lib/pkgconfig"
                    ]
                }
            ]
        },
        {
            "name": "git-lfs",
            "buildsystem": "simple",
            "build-commands": [
                "install -Dm755 git-lfs /app/bin/git-lfs"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/git-lfs/git-lfs/releases/download/v3.5.1/git-lfs-linux-amd64-v3.5.1.tar.gz",
                    "sha256": "6f28eb19faa7a968882dca190d92adc82493378b933958d67ceaeb9ebe4d731e",
                    "x-checker-data": {
                        "type": "json",
                        "url": "https://api.github.com/repos/git-lfs/git-lfs/releases/latest",
                        "url-query": ".assets[] | select(.name==\"git-lfs-linux-amd64-\" + $version + \".tar.gz\") | .browser_download_url",
                        "version-query": ".tag_name"
                    },
                    "only-arches": [
                        "x86_64"
                    ]
                },
                {
                    "type": "archive",
                    "url": "https://github.com/git-lfs/git-lfs/releases/download/v3.5.1/git-lfs-linux-arm64-v3.5.1.tar.gz",
                    "sha256": "4f8700aacaa0fd26ae5300fb0996aed14d1fd0ce1a63eb690629c132ff5163a9",
                    "x-checker-data": {
                        "type": "json",
                        "url": "https://api.github.com/repos/git-lfs/git-lfs/releases/latest",
                        "url-query": ".assets[] | select(.name==\"git-lfs-linux-arm64-\" + $version + \".tar.gz\") | .browser_download_url",
                        "version-query": ".tag_name"
                    },
                    "only-arches": [
                        "aarch64"
                    ]
                }
            ]
        },
        {
            "name": "p7zip",
            "no-autogen": true,
            "make-args": [
                "7z"
            ],
            "make-install-args": [
                "DEST_HOME=/app"
            ],
            "cleanup": [
                "/share"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/p7zip-project/p7zip/archive/refs/tags/v17.05.tar.gz",
                    "sha256": "d2788f892571058c08d27095c22154579dfefb807ebe357d145ab2ddddefb1a6",
                    "x-checker-data": {
                        "type": "json",
                        "url": "https://api.github.com/repos/p7zip-project/p7zip/releases/latest",
                        "version-query": ".tag_name",
                        "url-query": "\"https://github.com/p7zip-project/p7zip/archive/refs/tags/\\($version).tar.gz\""
                    }
                },
                {
                    "type": "shell",
                    "commands": [
                        "sed -i 's|/usr/local|/app|g' makefile.common"
                    ]
                }
            ]
        },
        {
            "name": "libfuse",
            "config-opts": [
                "UDEV_RULES_PATH=/app/etc/udev/rules.d",
                "INIT_D_PATH=/app/etc/init.d"
            ],
            "post-install": [
                "install -m a+rx fusermount-wrapper.sh /app/bin/fusermount"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/libfuse/libfuse/releases/download/fuse-2.9.9/fuse-2.9.9.tar.gz",
                    "sha256": "d0e69d5d608cc22ff4843791ad097f554dd32540ddc9bed7638cc6fea7c1b4b5"
                },
                {
                    "type": "patch",
                    "paths": [
                        "patches/fuse-disable-sys-mount-under-flatpak.patch",
                        "patches/fuse-2.9.2-namespace-conflict-fix.patch",
                        "patches/fuse-closefrom.patch"
                    ]
                },
                {
                    "type": "file",
                    "path": "fusermount-wrapper.sh"
                }
            ]
        },
        {
            "name": "maturin",
            "buildsystem": "simple",
            "build-commands": [
                "pip3 install --verbose --exists-action=i --no-index --find-links=file://${PWD} --prefix=${FLATPAK_DEST} maturin --no-build-isolation"
            ],
            "sources": [
                {
                    "type": "file",
                    "only-arches": [
                        "x86_64"
                    ],
                    "url": "https://files.pythonhosted.org/packages/95/02/572c1f2aed8a94da5cbc6037b935130491542845167dac8fd34936dfff29/maturin-1.6.0-py3-none-manylinux_2_12_x86_64.manylinux2010_x86_64.musllinux_1_1_x86_64.whl",
                    "sha256": "d92b045e90ed919a8a2520dda64e3f384e5e746ea51e1498cc6ac3e9e5c76054"
                },
                {
                    "type": "file",
                    "only-arches": [
                        "aarch64"
                    ],
                    "url": "https://files.pythonhosted.org/packages/37/a8/83dc94a4b5959ced19354fcce404107221d1f7460c9e28f61ea61bfa8ac9/maturin-1.6.0-py3-none-manylinux_2_17_aarch64.manylinux2014_aarch64.musllinux_1_1_aarch64.whl",
                    "sha256": "d67ca8dc7f3b2314bd3bf83c4de52645e220ee312fd526e53acc6a735f233fad"
                }
            ]
        },
        "flat-manager-client-deps.json",
        {
            "name": "ostree",
            "config-opts": [
                "--disable-man",
                "--with-systemdsystemgeneratordir=/app/lib/systemd/system-generators",
                "--without-systemdsystemunitdir",
                "--with-curl"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/ostreedev/ostree/releases/download/v2024.6/libostree-2024.6.tar.xz",
                    "sha256": "8b61c856697aa412f2f1724322ada40bdd7b1bf9e7783e2c594faa7a594f868f",
                    "x-checker-data": {
                        "type": "json",
                        "url": "https://api.github.com/repos/ostreedev/ostree/releases/latest",
                        "version-query": ".tag_name",
                        "url-query": ".assets | first | .browser_download_url"
                    }
                }
            ]
        },
        {
            "name": "python3-pyparsing",
            "buildsystem": "simple",
            "build-commands": [
                "pip3 install --verbose --exists-action=i --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} \"pyparsing\" --no-build-isolation"
            ],
            "sources": [
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/9d/ea/6d76df31432a0e6fdf81681a895f009a4bb47b3c39036db3e1b528191d52/pyparsing-3.1.2-py3-none-any.whl",
                    "sha256": "f9db75911801ed778fe61bb643079ff86601aca99fcae6345aa67292038fb742"
                }
            ]
        },
        {
            "name": "libxmlb",
            "buildsystem": "meson",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/hughsie/libxmlb/releases/download/0.3.19/libxmlb-0.3.19.tar.xz",
                    "sha256": "0a3ec258b12dbf10e5fe840b2421c84137eb7cc1b09c3de6210f3f7d51733733",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": 179028,
                        "stable-only": true,
                        "url-template": "https://github.com/hughsie/libxmlb/releases/download/$version/libxmlb-$version.tar.xz"
                    }
                }
            ]
        },
        {
            "name": "webp-pixbuf-loader",
            "buildsystem": "meson",
            "config-opts": [
                "-Dgdk_pixbuf_moduledir=/app/lib/gdk-pixbuf-2.0/2.10.0/loaders/"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/aruiz/webp-pixbuf-loader.git",
                    "commit": "52232e4ba282b2fed68e8fcb4b5d45ed0eaa4ed3",
                    "tag": "0.2.7",
                    "x-checker-data": {
                        "type": "git",
                        "tag-pattern": "^([\\d.]+)$"
                    }
                }
            ],
            "post-install": [
                "GDK_PIXBUF_MODULEDIR=/app/lib/gdk-pixbuf-2.0/2.10.0/loaders/ gdk-pixbuf-query-loaders > /app/lib/gdk-pixbuf-2.0/2.10.0/loaders.cache",
                "gdk-pixbuf-query-loaders >> /app/lib/gdk-pixbuf-2.0/2.10.0/loaders.cache"
            ]
        },
        {
            "name": "optipng",
            "config-opts": [
                "--with-system-libs"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://downloads.sourceforge.net/project/optipng/OptiPNG/optipng-0.7.8/optipng-0.7.8.tar.gz",
                    "sha256": "25a3bd68481f21502ccaa0f4c13f84dcf6b20338e4c4e8c51f2cefbd8513398c",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": 2571,
                        "stable-only": true,
                        "url-template": "https://downloads.sourceforge.net/project/optipng/OptiPNG/optipng-$version/optipng-$version.tar.gz"
                    }
                }
            ]
        }
    ]
}
